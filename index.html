<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Ca√ßa-palavras Backend & SQL</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #1e1e2e;
        color: #fff;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    h1 {
        background: #4a90e2;
        padding: 10px;
        margin: 0;
    }
    #score, #phase {
        font-size: 18px;
        margin: 5px;
    }
    #grid {
        display: grid;
        gap: 2px;
        justify-content: center;
        margin: 20px auto;
    }
    .cell {
        width: 35px;
        height: 35px;
        background: #2d2d3a;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        user-select: none;
        border-radius: 5px;
        font-weight: bold;
    }
    .cell.selected {
        background: #4a90e2;
    }
    .cell.found {
        background: #27ae60;
        color: #fff;
    }
    #words {
        max-width: 300px;
        margin: 0 auto;
        text-align: left;
    }
    #words li {
        list-style: none;
        padding: 5px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    #words li.found {
        text-decoration: line-through;
        color: #27ae60;
    }
    button {
        background: #4a90e2;
        border: none;
        padding: 10px 20px;
        color: white;
        font-size: 16px;
        cursor: pointer;
        margin-top: 15px;
        border-radius: 5px;
    }
</style>
</head>
<body>

<h1>Ca√ßa-palavras: Backend & SQL</h1>
<div id="score">Pontua√ß√£o: 0</div>
<div id="phase">Fase: 1 / 10</div>
<div id="grid"></div>
<ul id="words"></ul>
<button id="nextPhase" style="display:none;">Pr√≥xima Fase</button>

<script>
const phases = [
    {words: ["BACKEND","API","ROUTES","DATABASE","QUERY"], size: 10},
    {words: ["SELECT","INSERT","UPDATE","DELETE","TABLE"], size: 10},
    {words: ["SERVER","JSON","POST","GET","INDEX"], size: 10},
    {words: ["PRIMARY","FOREIGN","KEY","RELATION","JOIN"], size: 10},
    {words: ["MYSQL","POSTGRES","MONGODB","SQLITE","TRIGGER"], size: 10},
    {words: ["CACHE","SESSION","COOKIE","AUTH","TOKEN"], size: 10},
    {words: ["LINUX","SHELL","SCRIPT","BASH","CRON"], size: 10},
    {words: ["PYTHON","NODEJS","JAVASCRIPT","JAVA","PHP"], size: 10},
    {words: ["FRAMEWORK","LARAVEL","EXPRESS","SPRING","DJANGO"], size: 10},
    {words: ["APIREST","GRAPHQL","ENDPOINT","CLIENT","REQUEST"], size: 10}
];

let currentPhase = 0;
let score = 0;
let selectedCells = [];
let foundWords = [];

const gridElement = document.getElementById("grid");
const wordsElement = document.getElementById("words");
const scoreElement = document.getElementById("score");
const phaseElement = document.getElementById("phase");
const nextButton = document.getElementById("nextPhase");

// Fun√ß√£o para tentar inserir palavra com cruzamentos v√°lidos
function tryPlaceWord(grid, word, size) {
    let attempts = 0;
    while (attempts < 200) {
        attempts++;
        let dir = Math.floor(Math.random()*3); 
        let row = Math.floor(Math.random()*size);
        let col = Math.floor(Math.random()*size);

        let dr = (dir === 0) ? 0 : (dir === 1 ? 1 : 1);
        let dc = (dir === 0) ? 1 : (dir === 1 ? 0 : 1);

        if (row + dr * (word.length - 1) >= size || col + dc * (word.length - 1) >= size) {
            continue;
        }

        let canPlace = true;
        for (let i = 0; i < word.length; i++) {
            let r = row + dr * i;
            let c = col + dc * i;
            if (grid[r][c] !== "" && grid[r][c] !== word[i]) {
                canPlace = false;
                break;
            }
        }

        if (canPlace) {
            for (let i = 0; i < word.length; i++) {
                let r = row + dr * i;
                let c = col + dc * i;
                grid[r][c] = word[i];
            }
            return true;
        }
    }
    return false;
}

function generateGrid(size, words) {
    gridElement.innerHTML = "";
    gridElement.style.gridTemplateColumns = `repeat(${size}, 35px)`;
    foundWords = [];
    selectedCells = [];

    let grid = Array.from({length: size}, () => Array(size).fill(""));

    // Inserir palavras com cruzamentos permitidos
    words.forEach(word => {
        if (!tryPlaceWord(grid, word, size)) {
            console.warn(`N√£o foi poss√≠vel posicionar a palavra: ${word}`);
        }
    });

    // Preencher espa√ßos vazios
    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
            if (!grid[r][c]) grid[r][c] = letters[Math.floor(Math.random()*letters.length)];
        }
    }

    // Renderizar
    for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
            const cell = document.createElement("div");
            cell.className = "cell";
            cell.textContent = grid[r][c];
            cell.dataset.row = r;
            cell.dataset.col = c;
            cell.addEventListener("click", () => selectCell(cell, words));
            gridElement.appendChild(cell);
        }
    }

    // Lista de palavras
    wordsElement.innerHTML = "";
    words.forEach(w => {
        let li = document.createElement("li");
        li.textContent = w;
        li.id = `phase${currentPhase}-word-${w}`;
        wordsElement.appendChild(li);
    });
}

function isValidDirection(cells) {
    if (cells.length < 2) return true;
    let dr = cells[1].dataset.row - cells[0].dataset.row;
    let dc = cells[1].dataset.col - cells[0].dataset.col;
    return cells.every((cell, i) => {
        if (i === 0) return true;
        return (cell.dataset.row - cells[i-1].dataset.row == dr &&
                cell.dataset.col - cells[i-1].dataset.col == dc);
    });
}

function selectCell(cell, words) {
    if (cell.classList.contains("found")) return;

    if (cell.classList.contains("selected")) {
        cell.classList.remove("selected");
        selectedCells = selectedCells.filter(c => c !== cell);
    } else {
        cell.classList.add("selected");
        selectedCells.push(cell);
    }

    if (!isValidDirection(selectedCells)) {
        selectedCells.forEach(c => c.classList.remove("selected"));
        selectedCells = [];
        return;
    }

    const selectedWord = selectedCells.map(c => c.textContent).join("");
    const reverseWord = selectedWord.split("").reverse().join("");
    if (words.includes(selectedWord) || words.includes(reverseWord)) {
        const finalWord = words.includes(selectedWord) ? selectedWord : reverseWord;
        foundWords.push(finalWord);
        score += 10;
        scoreElement.textContent = `Pontua√ß√£o: ${score}`;
        selectedCells.forEach(c => {
            c.classList.remove("selected");
            c.classList.add("found");
        });
        document.getElementById(`phase${currentPhase}-word-${finalWord}`).classList.add("found");
        selectedCells = [];

        if (foundWords.length === words.length) {
            if (currentPhase < phases.length - 1) {
                nextButton.style.display = "inline-block";
            } else {
                alert("üéâ Parab√©ns! Voc√™ completou todas as fases!");
            }
        }
    }
}

nextButton.addEventListener("click", () => {
    currentPhase++;
    phaseElement.textContent = `Fase: ${currentPhase+1} / ${phases.length}`;
    nextButton.style.display = "none";
    generateGrid(phases[currentPhase].size, phases[currentPhase].words);
});

phaseElement.textContent = `Fase: 1 / ${phases.length}`;
generateGrid(phases[0].size, phases[0].words);
</script>
</body>
</html>
